(function(m){var s=m.iLearner||{},e=s,g=m.jQuery,p={API_ROOT:"/",PHOTO_URL:"/photos"},y=s.Tutor||{},c=s.Room||{},h=s.Util||{},i="Chan Chang Cheng Cheung Chin Ching Chiu Choi Chow Chu Chui Chun Chung Fan Fong Foo Fu Fung Ha Hau Heung Ho Hon Hong Hooi Hui Hung Ka Kam Keung Kiu Ko Kok Kong Ku Kung Kwok Lai Lam Lau Lay Lee Leung Li Liu Lo Loong Lui Luk Lung Ma Man Mang Mo Mok Ng Ngai Pak Pang Poon Sek Shek Sheung Shiu Sit Siu So Suen Sum Sung Sze Tai Tam Tang Tin Ting To Tong Tong Tou Tsang Tse Tseung Tso Tsui"+" Tuen Tung Wai Wan Wong Wong Wu Yam Yau Yeung Yim Yip Yiu Yu Yue Yuen".split(" "),x,a,v,b,r,f;m.iL=s;m.iLearner=s;e.Conf=g.extend({},p,e.Conf);s.Tutor=y;s.Room=c;s.Util=h;e.API_ROOT=e.Conf.API_ROOT;A();function z(B,C){return Promise.resolve(g.post(e.Conf.API_ROOT+"process_login.php",{login:B,password:C},null,"json")).then(function(D){if(D.result&&D.result[0]){x=parseInt(D.result[0].mid);a=D.result[0].acc;if(!x){return Promise.reject(Error("No member ID"))}return D.result[0]}else{return Promise.reject(Error("Invalid data from the server"))}})}s.Login=z;function w(){g.post(e.Conf.API_ROOT+"process_logout.php")}s.Logout=w;function A(){f=Promise.resolve(g.post(e.Conf.API_ROOT+"process_getinitdata.php",null,null,"json")).then(function(B){v=B.AdminStaff;b=g.map(B.classroom,function(C){return{id:C.crid,name:C.place}});r=g.map(B.tutor,function(C){var D={name:C.n,id:C.mid};D.colour=q(D);return D})})}function u(){return Promise.resolve(f).then(function(){return r})}y.all=u;function n(C){var B;if(r&&C){g.each(r,function(E,D){if(D.id==C){B=D;return false}});return B}return Promise.resolve(f.then(function(){return r}))}y.get=n;s.getTutors=n;function l(B,D){var C;if(!B){return{name:"",colour:"#999999"}}if(r){g.each(r,function(F,E){if(E.name==B){C=E;return false}})}if(!C&&D){C={name:B};C.colour=q(C);r.push(C)}return C}y.find=l;s.findTutor=l;function q(B){if(!B.hash){B.hash=SparkMD5.hash(B.name)}return"#"+B.hash.substr(0,6)}y.colour=q;function k(B){return j(B)}s.getRoom=k;function j(C){var B;if(b&&C){g.each(b,function(D,E){if(E.id==C){B=E;return false}});return B}return Promise.resolve(f.then(function(){return b}))}c.all=j;c.get=j;s.getRooms=j;function o(C){var B;if(!C){return{id:0,name:""}}if(b){g.each(b,function(D,E){if(E.name==C){B=E;return false}})}return B}c.find=o;s.findRoom=o;function t(B){return B.getFullYear()+"/"+(B.getMonth()+1)+"/"+B.getDate()}h.formatDate=t;s.formatDate=t;function d(B){B.name=g.trim(B.name);var C=B.name.match(/\w+/g);if(!C){return}else{if(C.length==1){B.forename=C[0];B.surname="";B.englishName=B.forename;B.chineseName=B.englishName}else{if(C.length==2){B.forename=C[0];B.surname=C[1];B.englishName=C[0]+" "+C[1];B.chineseName=B.englishName}else{if(C.length==3){B.forename="";B.surname=C[0];B.chineseName=C[0]+" "+C[1]+" "+C[2];B.englishName=B.chineseName}else{if(i.indexOf(C[0])>-1){B.forename=C[3];B.surname=C[0];B.englishName=B.forename+" "+B.surname;B.chineseName=C[0]+" "+C[1]+" "+C[2]}else{B.forename=C[0];B.surname=C[1];B.englishName=B.forename+" "+B.surname;B.chineseName=C[1]+" "+C[2]+" "+C[3]}}}}}}h.parseName=d;s.parseName=d;m.iLearner=s}(window));(function(C){var G=C.iLearner||{},c={},p={},m={},t=/\s*\w\d(?:\s?-\s?\w\d)?\s*/i,u=[{regex:/Trinity/,level:"K"},{regex:/GCSE/,level:"S"},{regex:/St\. Mary/,level:"P"},{regex:/DSE/,level:"S"},{regex:/Starters|Movers|Flyers/,level:"K"}],a="K1 K2 K3 P1 P2 P3 P4 P5 P6 F1 F2 F3 F4 F5 F6".split(" "),F={},h={},y={},i={},I={},w={},v={},z={};C.iL=G;G.Lesson=c;G.Course=p;G.Attendance=m;function g(L){return h[L]}c.get=g;function e(){var M=Array.prototype.slice.call(arguments),L,O,N;if(M.length==2){return n(M[0],M[1])}L=$.isPlainObject(M[0])?M[0]:{};if(L.course){return K(L.course)}if(!L.start){L.start=new Date}O={sDate:iL.formatDate(L.start)};if(L.tutor){O.Tutor=L.tutor.id}N=JSON.stringify(O);if(!w[N]){w[N]=Promise.resolve($.post(iL.API_ROOT+"process_getCalendarData.php",O,null,"json")).then(function(Q){var P=[];$.each(Q.CalendarCourse,function(W,ab){var T=new Date(ab.ScheduleDate),V=new Date(ab.ScheduleDate),R=iL.Tutor.find(ab.Tutor,true),S=ab.Coursetitle.match(t),Y=ab.Coursetitle.replace(t,""),aa=ab.CourseID,U=ab.CourseScheduleID,X=F[aa]||{id:aa,lessons:[]},Z=h[U]||{id:U,start:T,end:V,room:iL.Room.find(ab.Location),tutor:R,attendees:[]};X.code=ab.CourseName;X.title=Y;X.level=null;X.day=T.getDay();X.startTime=ab.Starttime;X.endTime=ab.endtime;X.tutor=R;D(T,ab.Starttime);D(V,ab.endtime);S=S&&S[0].replace(" ","");if(!S){$.each(u,function(ad,ac){if(ac.regex.test(Y)){S=ac.level;return false}})}X.level=S;F[X.id]=X;Z.attendees.length=0;h[Z.id]=Z;Z.course=X;if(!X.lessons){X.lessons=[]}if(X.lessons.indexOf(Z)==-1){X.lessons.push(Z)}P.push(Z)});$.each(Q.CalendarStudent,function(T,V){var U=iL.Student.get(V.MemberID)||{id:V.MemberID,name:V.nickname,photo:V.Accountname},S=h[V.CourseScheduleID],W=x(S,U)||{memberCourseID:null,lesson:S,student:U},R=S&&j(S,U);W.absent=V.Attendance=="0";iL.Util.parseName(U);S&&S.attendees.push(W);y[R]=W;iL.Student.add(U)});return P})}return w[N]}c.find=e;function o(N){var Q=N.start.getHours(),O=N.end.getHours(),M=Q<12?"AM":"PM",L=O<12?"AM":"PM",P={Action:"update",insertMode:null,tid:N.tutor.id,cstatus:0,courseID:N.course.id,coursescheduleID:N.id,cssid:N.course.id,csid:N.room.id,sdate:iL.formatDate(N.start),timefrom:l(Q),minutesfrom:l(N.start.getMinutes()),fromdt:M,timeto:l(O),minutesto:l(N.end.getMinutes()),todt:L,mon:0,tue:0,wed:0,thu:0,fri:0,sat:0,sun:0,coursetypechanged:0,orignal_coursetype:0};return Promise.resolve($.post(iL.API_ROOT+"process_updateCourseSchedule.php",P)).then(function(R){if(R.statuscode!=1){return Promise.reject()}})}c.save=o;function n(L,N){var M=L.id;if(!v[M]){v[M]={}}if(!v[M][N]){v[M][N]=p.lessons(L.course).then(function(P){var O=P.indexOf(L);if(N=="previous"){return P.slice(O-1,O)}else{if(N=="next"){return P.slice(O+1,O+2)}else{if(N=="future"){return P.slice(O)}else{if(N=="past"){return P.slice(0,O+1)}}}}})}return v[M][N]}function f(L){return e(L,"previous").then(function(M){return M[0]})}c.prev=f;function A(L){return e(L,"next").then(function(M){return M[0]})}c.next=A;function b(L){return e(L,"future")}c.future=b;function d(L){return k({lesson:L}).then(function(M){return M.map(function(N){return N.student})})}c.students=d;function r(L){return F[L]}p.get=r;function E(L){F[L.id]=L}p.add=E;function B(M){var L=new Date(),O=M.code?{searchCouseCode:M.code}:{searchCourseTitle:M.title,searchCourseCourseYear:M.year||L.getFullYear(),searchCourseCourseMonth:M.month||(L.getMonth()+1),searchTutor:M.tutor&&M.tutor.id},N=JSON.stringify(O);if(!i[N]){if(M.code){$.each(F,function(Q,P){if(P.code==M.code){i[N]=Promise.resolve([P]);return false}});if(i[N]){return i[N]}}i[N]=Promise.resolve($.post(iL.API_ROOT+"process_getCourseList.php",O,null,"json")).then(function(Q){var P=[];$.each(Q.courselist,function(S,T){var W=T.CourseID,V=T.CourseName.match(t),U=T.CourseName.replace(t,""),R=F[W]||{id:W,lessons:[]};V=V&&V[0].replace(" ","");if(!V){$.each(u,function(Y,X){if(X.regex.test(U)){V=X.level;return false}})}R.title=U;R.code=T.coursecode;R.level=V;R.subject=T.subject;F[W]=R;P.push(R)});$.each(Q.courseschedule,function(V,Z){var S=new Date(Z.ScheduleDate),U=new Date(Z.ScheduleDate),R=iL.Tutor.find(Z.tutorname,true),Y=Z.CourseID,T=Z.CourseScheduleID,W=F[Y]||{id:Y,lessons:[]},X=h[T]||{id:T,start:S,end:U,room:iL.Room.find(Z.location),tutor:R,attendees:[]};W.day=S.getDay();W.startTime=Z.Starttime;W.endTime=Z.endtime;W.tutor=R;D(S,Z.Starttime);D(U,Z.endtime);F[W.id]=W;h[X.id]=X;X.course=W;if(W.lessons.indexOf(X)==-1){W.lessons.push(X)}});return P})}return i[N]}p.find=B;function H(L){if(!I[L.id]){I[L.id]=Promise.resolve($.post(iL.API_ROOT+"process_getCourseDetail.php",{courseID:L.id},null,"json")).then(function(N){var M=N.coursedetail[0];L.code=M.CourseCode;L.title=M.CourseName.replace(t,"");L.room=iL.Room.get(M.DefaultClassroomID);L.paymentCycle=M.DefaultPaymentCycle=="2"?"lesson":"monthly";L.existingDiscount=M.DiscountForOldStudent;L.pricePerLesson=M.LessonFee;L.pricePerMonth=M.MonthlyFee;L.notes=M.Remark=="null"?"":M.Remark;L.subject=null;L.tutor=iL.Tutor.get(M.TutorMemberID);L.level=s(M);if(!L.level){L.level=M.CourseName.match(t)}if(!L.lessons){L.lessons=[]}$.each(N.coursedetailschedule,function(Q,R){var S=new Date(R.ScheduleDate),O=new Date(R.ScheduleDate),P;if(h[R.CourseScheduleID]){P=h[R.CourseScheduleID]}else{P={id:R.CourseScheduleID,start:S,end:O,room:iL.Room.get(R.ClassroomID),tutor:iL.Tutor.get(R.TutorMemberID),course:L,attendees:[]};D(S,R.Starttime);D(O,R.Endtime)}if(L.lessons.indexOf(P)==-1){L.lessons.push(P)}h[P.id]=P});L.lessons.sort(function(P,O){return P.start.getTime()<O.start.getTime()?-1:1});return L})}return I[L.id]}p.fetch=H;function K(L){return H(L).then(function(){return L.lessons})}p.lessons=K;function x(L,M){return y[j(L,M)]}m.get=x;function k(L){if(L.lesson){var M=L.lesson,N=M.id;if(!z[N]){z[N]=new Promise(function(P,O){$.post(iL.API_ROOT+"process_getCourseScheduleStudents.php",{scheduleID:M.id},function(Q){if(!M.attendees){M.attendees=[]}M.attendees.length=0;$.each(Q.coursestudent,function(R,T){var S=iL.Student.get(T.MemberID)||{id:T.MemberID,name:T.Lastname,photo:T.Accountname},U=x(M,S)||{lesson:M,student:S};iL.Util.parseName(S);U.memberCourseID=T.MemberCourseID;U.absent=T.absent=="1";iL.Student.add(S);M.attendees.push(U);y[j(M,S)]=U});P(M.attendees)},"json").fail(O)})}return z[N]}}m.find=k;function q(M){var L=j(M);return k({lesson:M.lesson}).then(function(){return y[L]})}m.fetch=q;function J(L){if(!L.memberCourseID){return q(L).then(J)}return Promise.resolve($.post(iL.Conf.API_ROOT+"process_updateStudentAttendance.php",{mcid:L.memberCourseID,absent:L.absent?0:1,coursescheduleID:L.lesson.id,absentReason:""}))}m.save=J;function j(L,M){if(arguments.length==1){return arguments[0].lesson.id+":"+arguments[0].student.id}return L.id+":"+M.id}function l(L){return(L<10)?"0"+L:L}function D(L,M){L.setHours(M.substr(0,2));L.setMinutes(M.substr(2,2))}function s(L){var M=[];a.forEach(function(N){if(L[N]=="1"){M.push(N)}});return M.join("-")}}(window));(function(h){var k=h.iLearner||{},q={},o={},j={},r={},b={},d={},i={};h.iL=k;k.Student=q;k.Subscription=j;k.Invoice=o;function s(t){return r[t]}q.get=s;function a(t){r[t.id]=t}q.add=a;function p(u){var t=new Date(),w={searchStudentName:u.name&&u.name.toLowerCase(),searchStudentMobile:u.phone,searchStudentSchool:u.school,searchStudentCourseYear:u.year===undefined?t.getFullYear():u.year,searchStudentCourseMonth:u.month===undefined?(t.getMonth()+1):u.month},v=JSON.stringify(w);if(u.clearCache){i[v]=undefined}if(!i[v]){i[v]=Promise.resolve($.post(iL.API_ROOT+"process_getMemberList.php",w,null,"json")).then(function(y){var x=[];y.memberlist.forEach(function(B){var C=B.memberID,A=r[C]||{id:C},z=(B.Lastname&&B.nickname)?(B.Lastname.length>B.nickname.length?B.Lastname:B.nickname):(B.Lastname||B.nickname);z=$.trim(z);A.name=z;A.gender=B.Gender=="1"?"male":"female";A.grade=B.Grade;A.account=B.AccountName;A.photo=iL.Conf.PHOTO_URL+B.AccountName+".jpg";A.school=B.School;A.phone=B.mobile;A.registeredDate=new Date(B.RegDate);iL.Util.parseName(A);r[C]=A;x.push(A)});return x})}return i[v]}q.find=p;function g(t){t=r[t.id]||t;if(!d[t.id]){d[t.id]=Promise.resolve($.post(iL.API_ROOT+"process_getMemberDetail.php",{memberID:t.id},null,"json")).then(function(x){var w=[],u,v={};if(x.memberdetail){$.each(x.memberdetail,function(z,A){var y=(A.lastname&&A.Nickname)?(A.lastname.length>A.Nickname.length?A.lastname:A.Nickname):(A.lastname||A.Nickname);y=$.trim(y);if(A.isStudent=="1"){t.name=y;t.gender=A.Gender=="1"?"male":"female";t.grade=A.Grade;t.account=A.AccountName;t.photo=iL.Conf.PHOTO_URL+A.AccountName+".jpg";t.school=A.School;t.phone=A.Mobile;t.notes=A.Remarks;t.birthDate=new Date(A.BirthYear,A.BirthMonth-1,A.BirthDay);t.notesPayment=A.RemarkAboutPayment;t.nameChinese=A.Chiname;t.schoolStart=A.schooltimefrom;t.schoolEnd=A.schooltimeto;t.soco=A.isSOCO=="1";t.entryChannel1=A.whyjoinusextendtext1;t.entryChannel2=A.whyjoinusextendtext2;iL.Util.parseName(t);t.guardians=w;r[t.id]=t;return false}else{if(A.isGuardian=="1"){u={accountID:A.AccountName,relationship:A.Relationship,name:A.lastname,nameChinese:A.Chiname,nickname:A.Nickname,email:A.emailaddress,address:A.Address,occupation:A.Occupation,phone:A.Mobile,phoneHome:A.HomeNo,phoneOffice:A.OfficeNo};w.push(u)}}})}if(x.memberCourseBalance){$.each(x.memberCourseBalance,function(B,H){var G=H.CourseID,D=parseInt(H.Nooflesson),y=parseInt(H.shouldpaid),z=y/D,K,C=iL.Course.get(G)||{id:G},J=iL.Subscription.get(C,t)||{id:null,course:C,student:t,invoices:[]},F=parseInt(H.Discount)||0,I=parseInt(H.Amount)||y,E=parseInt(H.AmountAfterDiscount)||I-F,A={id:H.MemberCourseInvoiceID,year:parseInt(H.invoiceyear),month:parseInt(H.invoicemonth),lessonCount:D,paid:H.Paid=="1",amount:E,originalAmount:I,discount:I-E,handledBy:H.handleby,memberID:H.memberID,memberCourseID:H.membercourseID};C.title=H.Coursename;C.code=H.CourseCode;C.existingDiscount=parseInt(H.DiscountForOldStudent);C.pricePerLesson=z;J.unpaid=0;J.withdrawn=H.withdrawal=="1";J.existingStudent=false;J.lastPaymentIndex=0;iL.Course.add(C);iL.Subscription.add(J);K=A.year*100+A.month;if(A.paid&&K>J.lastPaymentIndex&&J.existingDiscount){J.existingStudent=(A.discount/A.lessonCount>=J.existingDiscount);J.lastPaymentIndex=K}if(!J.invoices){J.invoices=[]}J.invoices.push(A);if(!A.paid){J.unpaid+=1}v[e(J)]=J});t.subscriptions=v}return t})}return d[t.id]}q.fetch=g;function n(u){var t=u.guardians[0],v={Action:"update",MemberID:u.id,MemberDetailNameinEnglish:u.englishName,MemberDetailRemark:u.notes,MemberDetailRemarkPayment:u.notesPayment,MemberDetailNameinChinese:u.nameChinese,MemberDetailNickname:u.name,MemberDetailBirthDay:iL.Util.formatDate(u.birthDate),MemberDetailGender:u.gender=="male"?"1":"0",MemberDetailGrade:u.grade,MemberDetailSchool:u.school,MemberDetailSchooltimefrom:u.schoolStart,MemberDetailSchooltimeto:u.schoolEnd,isSOCO:u.soco?1:0,GuardianDetailMemberID:t.accountID,GuardianDetailRelationship:t.relationship,GuardianDetailNameinEnglish:t.name,GuardianDetailNameinChinese:t.nameChinese,GuardianDetailNickname:t.nickname,GuardianDetailEmail:t.email,GuardianDetailAddress:t.address,GuardianDetailOccupation:t.occupation,GuardianDetailHomeNo:t.phoneHome,GuardianDetailMobileNo:u.phone,GuardianDetailOfficeNo:t.phoneOffice,whyjoinusextendtext1:u.entryChannel1,whyjoinusextendtext2:u.entryChannel2};return Promise.resolve($.post(iL.API_ROOT+"process_updateMemberInformation.php",v,null,"json"))}q.save=n;function l(t){var u={MemberCourseID:t.memberCourseID,InvoiceYear:t.year,InvoiceMonth:t.month,shouldpay:t.originalAmount,AmountAfterDiscount:t.amount,paymentmethod:t.paymentMethod=="cash"?1:2,ChequeNo:t.chequeNumber,CouponCode:t.coupons.join(","),issuedate:t.date,htmlselect_Discountvalue_val:t.originalAmount-t.amount,htmlselect_Discounttype_val:1};return Promise.resolve($.post(iL.API_ROOT+"process_updateMemberInvoice.php",u,null,"json")).then(function(v){t.id=v.iID;t.handledBy=v.handle;t.paid=true})}o.save=l;function m(u,t){var v={membercourseinvoiceID:u.id,reason:t};return Promise.resolve($.post(iL.API_ROOT+"process_removeMemberInvoice.php",v,null,"json")).then(function(w){u.id=0;u.handledBy=undefined;u.paid=false})}o.voidInvoice=m;function f(u){var t=e.apply(null,arguments);return b[t]}j.get=f;function c(u){var t=e(u);b[t]=u}j.add=c;function e(t,v){var u=arguments;if(u.length==2){return t.id+":"+v.id}return u[0].course.id+":"+u[0].student.id}}(window));(function(k){var b=k.iLearner||{},n={},f={},i={},o={},h,m={wh1label:"Politeness",wh2label:"Attentiveness",wh3label:"Participation",wh4label:"Effort"},g="idmembercoursereportcard ap1label ap1value ap1progress ap2label ap2value ap2progress ap3label ap3value ap3progress ap4label ap4value ap4progress wh1label wh1value wh1progress wh2label wh2value wh2progress wh3label wh3value wh3progress wh4label wh4value wh4progress generalcomments suggestions learningfocus lessoncount".split(" ");k.iL=b;b.Report=n;function p(q){return i[q]}n.get=p;function j(q){var s={},r;q=q||{};if(q.tutor){s.searchTutor=q.tutor.id||q.tutor}if(q.from){s.searchDateFrom=formatDate(q.from)}if(q.to){s.searchDateTo=formatDate(q.to)}r=JSON.stringify(s);if(q.clearCache){f[r]=undefined}if(!f[r]){f[r]=Promise.resolve($.post(iL.API_ROOT+"process_getMemberReportCardList.php",s,null,"json")).then(function(u){var t;if(u.MemberReportCardList){t=u.MemberReportCardList;$.each(t,function(v,w){w.id=w.membercourseid;w.studentId=w.memberID;w.name=w.nickname;w.course={id:w.courseID,title:w.coursename,startTime:w.starttime,endTime:w.endtime};w.memberCourseId=w.membercourseid;w.complete=(w.completed=="1");w.tutor=q.tutor;iL.parseName(w);i[w.id]=w})}return t})}return f[r]}n.find=j;function d(r){var q=$.Deferred(),s=q.promise();$.when($.post(iL.API_ROOT+"process_getMemberReportCardDetail.php",{membercourseID:r.id},null,"json"),c(r.courseName)).done(function(u,t){var w=u[0].MemberReportCardDetail[0],y="ap1label ap2label ap3label ap4label wh1label wh2label wh3label wh4label".split(" "),x={},v;$.extend(x,m);$.extend(x,t);for(v in y){if(!w[y[v]]){w[y[v]]=undefined}}$.extend(x,w);x.tutor=undefined;$.extend(r,x);q.resolve(r)}).fail(q.reject);return s}n.fetch=d;function l(s){var t={},r,q;s.complete=true;for(r in g){q=g[r];t[q]=s[q]}return $.post(iL.API_ROOT+"process_updateMemberReportCardDetail.php",t,null,"json")}n.save=l;function a(){if(!h){h=$.Deferred();$.get(iL.API_ROOT+"comment.php").done(function(r){var q={good:[],average:[],suggestions:[],focus:[]};q.good.regex=/good_comments\.push\("([^"]+)"\)/g;q.average.regex=/average_comments\.push\("([^"]+)"\)/g;q.suggestions.regex=/suggestions\.push\("([^"]+)"\)/g;q.focus.regex=/focus\.push\("([^"]+)"\)/g;$.each(q,function(s,t){$.each(r.match(t.regex),function(u,v){t.regex.lastIndex=0;t.push(t.regex.exec(v)[1].replace("XXX","{ forename }").replace(/\bshe\b/g,"{ pronounSubject }").replace(/\bShe\b/g,"{ pronounSubjectCapitalize }").replace(/\bherself\b/g,"{ pronounReflexive }").replace(/\bher\b/g,"{ pronounPossesive }").replace(/\bHer\b/g,"{ pronounPossesiveCapitalize }").replace(/\bgirl\b/g,"{ nounGender }").replace(/\bhe\b/g,"{ pronounSubject }").replace(/\bHe\b/g,"{ pronounSubjectCapitalize }").replace(/\bhimself\b/g,"{ pronounReflexive }").replace(/\bhis\b/g,"{ pronounPossesive }").replace(/\bHis\b/g,"{ pronounPossesiveCapitalize }").replace(/\bhim\b/g,"{ pronounObject }").replace(/\bboy\b/g,"{ nounGender }"))});t.regex=undefined});h.resolve(q)})}return h.promise()}n.getComments=a;function c(s){var q,r;if(!o[s]){q=$.Deferred();r=$.post(iL.API_ROOT+"process_getCourseLearningFocus.php",{coursename:s},null,"json");r.done(function(u){var t=u.CourseFocusObject[0],v={};if(t){v.ap1label=t.ap1;v.ap2label=t.ap2;v.ap3label=t.ap3;v.ap4label=t.ap4}q.resolve(v)});o[s]=q.promise()}return o[s]}function e(s,q,r){c(s).done(function(t){t[q]=r})}n.setCourseLearningFocus=e}(window));